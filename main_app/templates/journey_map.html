{% extends 'base.html' %}
{% load ansi_shadow_tags %}

{% block content %}
<div class="terminal-container">
    <div class="terminal-header">
        {% ansi_shadow "FINANCIAL JOURNEY MAP" %}
    </div>
    
    <div class="terminal-body">
        <div class="journey-map-container">
            {% if user_modes %}
                <div class="journey-timeline">
                    {% for mode in user_modes %}
                        {% if mode.unlocked %}
                        <a href="{% url 'mode_dashboard' mode.name %}" class="journey-node-link">
                        {% endif %}
                        <div class="journey-node {% if mode.unlocked %}unlocked{% else %}locked{% endif %}" {% if not mode.unlocked %}title="Continue your financial journey to unlock this mode"{% endif %}>
                            <div class="mode-icon">{{ mode.icon|default:"ðŸ’°" }}</div>
                            <div class="mode-name">{{ mode.name }}</div>
                            <div class="mode-status">
                                {% if mode.unlocked %}
                                    <span class="status-unlocked">UNLOCKED</span>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: {{ mode.progress_percentage }}%;"></div>
                                    </div>
                                    <div class="progress-text">{{ mode.progress_percentage }}%</div>
                                {% else %}
                                    <span class="status-locked">LOCKED</span>
                                {% endif %}
                            </div>
                            {% if mode.description %}
                                <div class="mode-description">{{ mode.description }}</div>
                            {% endif %}
                        </div>
                        {% if mode.unlocked %}
                        </a>
                        {% endif %}
                        
                        {% if not forloop.last %}
                            <div class="journey-connector {% if mode.unlocked %}active{% endif %}"></div>
                        {% endif %}
                    {% endfor %}
                </div>
            {% else %}
                <div class="empty-journey">
                    <p>No financial modes available yet. Start your journey by unlocking your first mode!</p>
                </div>
            {% endif %}
        </div>
    </div>
    
    <div class="terminal-footer">
        <div class="footer-actions">
            <a href="{% url 'unlocked_modes' %}" class="terminal-button">View All Modes</a>
            <a href="{% url 'home' %}" class="terminal-button">Back to Dashboard</a>
        </div>
    </div>
    
    <div class="function-keys">
        <div class="function-key" onclick="showHelpInfo()">F1-Help</div>
        <div class="function-key" onclick="window.location.href='{% url 'home' %}'">F2-Home</div>
        <div class="function-key" onclick="window.location.href='{% url 'unlocked_modes' %}'">F3-Modes</div>
        <div class="function-key" onclick="window.location.href='{% url 'transaction_list' %}'">F4-Ledger</div>
    </div>
    
    <div class="status-bar">
        <span id="status-message">READY.</span>
        <span class="status-bar-brand">LEDGERLINE: Terminal Edition</span>
        <span>{% now "m/d/Y" %}</span>
    </div>

<script>
function showHelpInfo() {
  const helpText = `JOURNEY MAP HELP:
- This is your financial journey map showing all available modes
- Unlocked modes can be clicked to view detailed information
- Locked modes will become available as you continue your financial journey
- Continue using LEDGERLINE to unlock more modes
- Each mode represents different financial patterns and behaviors`;
  
  // Create terminal output if it doesn't exist
  if (!document.querySelector('.terminal-output')) {
    const terminalOutput = document.createElement('div');
    terminalOutput.className = 'terminal-output';
    document.querySelector('.terminal-container').insertBefore(
      terminalOutput, 
      document.querySelector('.terminal-body')
    );
  }
  
  // Find or create terminal output
  let output = document.querySelector('.terminal-output');
  
  // Update content
  output.innerHTML = helpText.replace(/\n/g, '<br>');
  
  // Update status
  document.getElementById('status-message').textContent = "Displaying help documentation";
}
</script>
</div>
{% endblock %}

{% block styles %}
<style>
    .journey-map-container {
        padding: 20px;
    }
    
    .journey-timeline {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 20px 0;
    }
    
    .journey-node-link {
        text-decoration: none;
        display: block;
        width: 80%;
        max-width: 500px;
        cursor: pointer;
    }
    
    .journey-node {
        background-color: #111;
        border: 2px solid #333;
        border-radius: 8px;
        padding: 15px;
        width: 100%;
        margin: 10px 0;
        text-align: center;
        transition: all 0.3s ease;
    }
    
    .journey-node.unlocked {
        border-color: #5f5;
        box-shadow: 0 0 10px rgba(95, 255, 95, 0.5);
    }
    
    .journey-node.unlocked:hover {
        transform: translateY(-3px);
        box-shadow: 0 0 15px rgba(95, 255, 95, 0.7);
    }
    
    .journey-node.locked {
        filter: grayscale(1);
        opacity: 0.7;
        cursor: not-allowed;
    }
    
    .journey-connector {
        height: 40px;
        width: 4px;
        background-color: #333;
    }
    
    .journey-connector.active {
        background-color: #5f5;
        box-shadow: 0 0 10px rgba(95, 255, 95, 0.5);
    }
    
    .mode-icon {
        font-size: 2em;
        margin-bottom: 10px;
    }
    
    .mode-name {
        font-size: 1.5em;
        font-weight: bold;
        margin-bottom: 5px;
        text-transform: uppercase;
    }
    
    .mode-status {
        margin: 10px 0;
    }
    
    .status-unlocked {
        color: #5f5;
        font-weight: bold;
    }
    
    .status-locked {
        color: #f55;
        font-weight: bold;
    }
    
    .progress-bar {
        background-color: #222;
        height: 10px;
        border-radius: 5px;
        margin: 10px 0;
        overflow: hidden;
    }
    
    .progress-fill {
        background-color: #5f5;
        height: 100%;
        transition: width 0.5s ease-in-out;
    }
    
    .progress-text {
        font-size: 0.9em;
        color: #5f5;
    }
    
    .mode-description {
        margin-top: 10px;
        font-style: italic;
        color: #aaa;
    }
    
    .empty-journey {
        text-align: center;
        padding: 30px;
        color: #aaa;
    }
    
    .terminal-footer {
        margin-top: 20px;
        text-align: center;
    }
    
    .footer-actions {
        display: flex;
        justify-content: center;
        gap: 15px;
    }
    
    .terminal-button {
        background-color: #333;
        color: #fff;
        border: none;
        padding: 8px 16px;
        border-radius: 4px;
        cursor: pointer;
        text-decoration: none;
        transition: all 0.2s ease;
    }
    
    .terminal-button:hover {
        background-color: #555;
        box-shadow: 0 0 8px rgba(255, 255, 255, 0.3);
    }
</style>
{% endblock %} 